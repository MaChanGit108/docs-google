---
breadcrumb: PCF Services
title: Installing the Service Broker
---

This topic describes how to install the GCP Service Broker by configuring your GCP account and importing the product file into Pivotal Cloud Foundry (PCF) Operations Manager (Ops Manager).

##<a id="setup"></a>Step 1: Set up your GCP Project and Service Account

Follow these steps to set up your "root" Service Account.

1. From the GCP console, navigate to **IAM & Admin** > **Service accounts** and click **Create Service Account**. 
1. Enter a **Service account name**. 
1. For **Role**, choose **Project** > **Owner**. 
1. Select the checkbox to **Furnish a new Private Key**, then click **Create**. 
1. Save the automatically downloaded key file in a secure location.

##<a id="setup"></a>Step 2: Create a Service Broker Database

You can use any MySQL database to back the Service Broker. To use GCP Cloud SQL, follow the instructions below:

1. From the GCP console, select **SQL**, then click **Create instance**. 
1. Choose either **Second Generation** or **First Generation**. 
1. Configure your database:
	* Enter an **Instance ID**. 
	* Choose a **Database version**. 
	* Choose a **Region** and **Zone** in which to host the database. 
	* Select a **Machine type**. 
	* Select a **Storage type**. 
	* Enter a **Storage capacity**. 
	* Enable automatic storage increase?
	* Create failover replica?
	* Enable automated backups?
	* Enable binary logging?
	* Maintenance window?
	* Authorized networks?
1. Click **Create**.
1. Once the instance boots, click its name in the list of SQL instances. 
1. Select **Access Control** > **SSL**.
1. Click **Create Client Certificate**. 
1. Enter a name and click **Add**. 
1. A popup appears. Download the three certificate files and save them in a secure location.
1. Record the connection string given at the bottom of the popup.
1. Under **Access Control** > **Authorization**, click **Add Network**. 
1. Enter `0.0.0.0/0` in the **Network** field and click **Done**. 
1. From a terminal window, connect to the host machine using the connection string you recorded. 
1. Run the following commands:
	1. `CREATE DATABASE servicebroker;`
	1. `CREATE USER 'USERNAME'@'%' IDENTIFIED BY 'PASSWORD';`
	1. `GRANT ALL PRIVILEGES ON servicebroker.* TO 'USERNAME'@'%' WITH GRANT OPTION;`

##<a id="install"></a>Step 3: Install in Ops Manager

To install the GCP Service Broker tile in Ops Manager, complete the following steps:

1. Download the GCP Service Broker product file from [Pivotal Network](https://network.pivotal.io/products/gcp-service-broker).

1. From the Ops Manager Installation Dashboard, click **Import a Product** to upload the product file.

1. Click **Add** next to the uploaded product description in the **Available Products** view to add this product to your staging area.

##<a id="install"></a>Step 4: Configure in Ops Manager

Click the newly added tile and configure the following sections:

###<a id="root-service-account"></a>Root Service Account
1. Click **Root Service Account**. 
1. Paste the contents of your service account private key file from [Step 1](#setup) into the text box. 
1. Click **Save**. 

###<a id="database-properties"></a>Database Properties
1. Click **Database Properties**. 
1. Fill in your Service Broker backing database properties?
1. Click **Save**. 

###<a id="plans"></a>Dynamic Service Plans
1. Click **Dynamic Service Plans**. 
1. To create a plan, click **Add**. 
1. Enter a plan name, a display name, and a description to display in the database.
1. Enter a case-sensitive **Tier** value. See the [Cloud SQL Pricing](https://cloud.google.com/sql/pricing) topic for details. 
1. (Optional) If you selected a first generation instance type when creating your Cloud SQL database, you can change your pricing plan
1. (Optional) If you selected a second generation instance type when creating your Cloud SQL database, enter a maximum disk size in GB. 
1. Click **Save**. 


##<a id="confirm"></a>Step 4: Confirm Installation

<p class="note"><strong>Note</strong>: The GCP Service Broker installs an app called <code>gcp-service-broker</code> in the <code>gcp-service-broker-space</code> space of the <code>gcp-service-broker-org</code> org.</p>

1. After Ops Manager finishes the installation, the **GCP Service Broker** appears as a green tile in the **Installation Dashboard**.

1. In Apps Manager, all orgs and spaces show the new services in the Services Marketplace. Users can create instances of these services through Apps Manager or via the cf CLI. Review the [USING GCP Service Broker](using.html) topic for more information.
